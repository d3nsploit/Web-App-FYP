{% extends 'base.html' %}

{% block head %}
<title>ScanMe</title>
{% endblock %}



{% block body %}
<div class="result-page" id="result-page">
  <div>
    <form method="POST" action="{{ url_for('result') }} ">
      <input class="scan-form" name="url" type="text" placeholder="Scan a URL" required />
      <input class="btn-result" type="submit" value="ScanMe">
    </form>
  </div>

  <div class="row row-result">

    <!-- left Column -->
    <div class="column left">
      <h4>Screenshot</h4>
      <h2><img id="webImage" src="{{ data2 }}"></h2>
      <p id="myModal" class="modal">
        <!-- The Close Button -->
        <span class="close">&times;</span>
        <!-- Modal Content (The Image) -->
        <img class="modal-content" id="img01">
      </p>
      <br>
      <button type="button" class="btn btn-danger btn-size" style="margin-left: 1rem;">Report</button>
      <button id="download" class="btn btn-info btn-size">Download</button>
      <form action="{{ url_for('result') }}" method="POST">
        <button name="url" class="btn btn-warning btn-size" value="{{ data0 }}">Rescan</button>
      </form>
    </div>

    <!-- right Column -->
    <div class="column right" id="haatu">
      <h4>Submitted URL</h4>
      <p class="url-link"> {{ data0 }} </p>
      <hr>
      <h4>Submitted On</h4>
      <p class="url-link"> {{ data1 }} </p>
      <hr>
      <h4>Existing Web Result</h4>
      <p>VirusTotal : </p>
      <p>URLScan.io : </p>
      <p>Sucuri :</p>
    </div>

        <div class="column left-sum">
          <br><br><h4>Result Summary</h4>
          {% if data3 == 'benign'%}
           <p>URL Status: Secure</p>
           {% else %}
           <p>URL Status: Malicious</p>
          {% endif %}
           <p>Main Domain: {{ data4 }}</p>
           <p>Status Code: {{ data5 }}</p>
           <p>Content Size: {{ data6 }} bytes</p>

        </div>
  
  
        <div class="column right-sum">
          <br><br><br><br><p>IP Address: {{ data7 }}</p>
          <p>Redirects: {{ data8 }}</p>
          <p>Date Created: {{ data9 }}</p>
          <p>Country: {{ data10 }}</p>
        </div>
    



   
  </div>
</div>




<script>
  // Get the modal
  var modal = document.getElementById("myModal");

  // Get the image and insert it inside the modal - use its "alt" text as a caption
  var img = document.getElementById("webImage");
  var modalImg = document.getElementById("img01");
  var captionText = document.getElementById("caption");
  img.onclick = function () {
    modal.style.display = "block";
    modalImg.src = this.src;
    captionText.innerHTML = this.alt;
  }

  // Get the <span> element that closes the modal
  var span = document.getElementsByClassName("close")[0];

  // When the user clicks on <span> (x), close the modal
  span.onclick = function () {
    modal.style.display = "none";
  }
</script>

<script>
  window.onload = function () {
  document.getElementById("download")
      .addEventListener("click", () => {
          const invoice = this.document.getElementById("result-page");
          console.log(invoice);
          console.log(window);
          html2pdf().from(invoice).save();
      })
}
</script>

{% endblock %}